# **🔒 MongoDB Security – Authentication, Encryption & Best Practices 🚀**

MongoDB security is **crucial** to prevent **unauthorized access, data breaches, and attacks** like **NoSQL Injection, Privilege Escalation, and Data Exfiltration**.

---

## **🔑 1️⃣ Authentication – How MongoDB Verifies Users**

💡 **Authentication ensures that only authorized users can connect to MongoDB.**

### **📌 Supported Authentication Methods**

✔️ **SCRAM (Salted Challenge Response Authentication Mechanism) – Default method in MongoDB.**  
✔️ **X.509 Certificates – Used for client-server authentication in secure environments.**  
✔️ **LDAP (Lightweight Directory Access Protocol) – Integrates with enterprise authentication.**  
✔️ **Kerberos – Secure authentication in corporate networks.**

---

### **🔍 How to Enable Authentication in MongoDB**

By default, **MongoDB does NOT require authentication**, which is a security risk.

#### **💡 Steps to Enable Authentication**

1️⃣ **Create an admin user in the `admin` database.**

```json
use admin
db.createUser({
  user: "admin",
  pwd: "StrongPassword123!",
  roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
})
```

2️⃣ **Enable authentication in `mongod.conf`.**

```yaml
security:
  authorization: enabled
```

3️⃣ **Restart MongoDB with authentication.**

```bash
sudo systemctl restart mongod
```

4️⃣ **Login as an authenticated user.**

```bash
mongo -u admin -p --authenticationDatabase admin
```

✔️ **Now, only authenticated users can access MongoDB.**

---

## **🏷️ 2️⃣ Authorization & Role-Based Access Control (RBAC)**

💡 **Authorization determines what users can do once they authenticate.**

MongoDB uses **Role-Based Access Control (RBAC)** to manage **permissions**.

### **📌 Built-in Roles**

| **Role**         | **Permissions**                                       |
| ---------------- | ----------------------------------------------------- |
| **read**         | Can read data but not modify it.                      |
| **readWrite**    | Can read & write data but cannot modify settings.     |
| **dbAdmin**      | Can modify database structure (indexes, collections). |
| **userAdmin**    | Can create and manage users & roles.                  |
| **clusterAdmin** | Full control over replication & sharding.             |

✔️ **Best Practice:** **Grant the **least privileges** necessary for each user.**

#### **💡 Example: Create a Read-Only User for `customers` Database**

```json
use customers
db.createUser({
  user: "readonly",
  pwd: "SecurePass123!",
  roles: [ { role: "read", db: "customers" } ]
})
```

✔️ **Now, the `readonly` user can only view data but cannot modify it.**

---

## **🌍 3️⃣ Network Security – Preventing Unauthorized Access**

MongoDB should **never be exposed to the public internet** without security measures.

### **💡 How to Secure MongoDB Network Access**

✔️ **Bind MongoDB to localhost or a private IP.**

```yaml
net:
  bindIp: 127.0.0.1
```

✔️ **Use a Firewall (`iptables` or `ufw`) to restrict external access.**

```bash
sudo ufw allow from 192.168.1.100 to any port 27017
```

✔️ **Enable TLS/SSL encryption for secure connections.**  
✔️ **Disable HTTP Status Interface (`httpInterfaceEnabled: false`).**  
✔️ **Use a VPN or SSH Tunnel to access MongoDB remotely.**

---

## **🔐 4️⃣ Encryption – Securing Data at Rest & in Transit**

💡 **MongoDB provides encryption to protect sensitive data.**

### **📌 Encryption at Rest (Data Stored on Disk)**

✔️ **MongoDB Enterprise Edition supports WiredTiger Encryption.**  
✔️ **Encryption uses AES-256 with local or cloud-managed keys.**  
✔️ **Enable encryption in `mongod.conf`:**

```yaml
security:
  enableEncryption: true
  encryptionKeyFile: /etc/mongodb-encryption-key
```

### **📌 Encryption in Transit (Data in Network)**

✔️ **Use TLS/SSL to encrypt connections between clients & servers.**  
✔️ **Enable TLS/SSL in `mongod.conf`:**

```yaml
net:
  ssl:
    mode: requireSSL
    PEMKeyFile: /etc/ssl/mongodb.pem
```

✔️ **Force clients to connect securely:**

```bash
mongo --ssl --sslPEMKeyFile /etc/ssl/mongodb.pem
```

✔️ **Now, all data is encrypted in transit, preventing man-in-the-middle attacks.**

---

## **📜 5️⃣ MongoDB Security Best Practices**

✔️ **Enable authentication & use strong passwords.**  
✔️ **Restrict network access & never expose MongoDB to the public.**  
✔️ **Use Role-Based Access Control (RBAC) to grant minimal permissions.**  
✔️ **Enable TLS/SSL encryption for secure communication.**  
✔️ **Use MongoDB Enterprise for built-in data encryption.**  
✔️ **Regularly back up data & test disaster recovery plans.**  
✔️ **Monitor logs (`mongod.log`) for suspicious activity.**

---
