# ðŸ“Š SQL Server Practice Questions (Enhanced Descriptions)

## **Employee & Salary Related**

```sql
-- Departments table
CREATE TABLE Departments (
    dept_id   INT PRIMARY KEY,
    dept_name NVARCHAR(100) NOT NULL
);

-- Employees table
CREATE TABLE Employees (
    emp_id    INT PRIMARY KEY,
    emp_name  NVARCHAR(100) NOT NULL,
    dept_id   INT NULL FOREIGN KEY REFERENCES Departments(dept_id),
    salary    DECIMAL(12,2) NOT NULL,
    hire_date DATE NOT NULL
);
```

---

**1.** Retrieve the **second highest salary** from the **Employees** table.  
**2.** List the **top 3 highest-paid employees** with their names and salaries.  
**3.** Find the **employees who earn more than the average salary** in the company.  
**4.** Show the **number of employees in each department**.  
**5.** Find the **departments where the average salary is greater than 10,000**.  
**6.** Retrieve all employees who **do not belong to any department** (handle NULLs).  
**7.** Get the list of employees who **joined in the year 2022**.  
**8.** Display employees who have the **same salary as at least one other employee**.  
**9.** Find the **highest-paid employee in each department**.  
**10.** Show the **total salary expense for each department**.

---

## **Customer & Orders**

```sql
-- Customers table
CREATE TABLE Customers (
    cust_id    INT PRIMARY KEY,
    cust_name  NVARCHAR(100) NOT NULL,
    email      NVARCHAR(150) NULL
);

-- Orders table
CREATE TABLE Orders (
    order_id    INT PRIMARY KEY,
    cust_id     INT NOT NULL FOREIGN KEY REFERENCES Customers(cust_id),
    order_date  DATE NOT NULL
);

-- OrderItems table
CREATE TABLE OrderItems (
    order_item_id INT PRIMARY KEY,
    order_id      INT NOT NULL FOREIGN KEY REFERENCES Orders(order_id),
    product_id    INT NOT NULL, -- FK to Products
    qty           INT NOT NULL,
    price         DECIMAL(12,2) NOT NULL
);
```

---

**11.** Retrieve the **customers who never placed an order**.  
**12.** List the **top 5 customers by total order amount**.  
**13.** Find the **customers who placed orders in both 2022 and 2023**.  
**14.** Show the **total number of orders placed each month**.  
**15.** Find the **customers who placed the highest number of orders**.  
**16.** Retrieve the **average order value per customer**.  
**17.** List all customers who placed orders with a value **greater than 5,000**.  
**18.** Show the **customers who placed orders but have no email address registered**.  
**19.** Find the **most recent order date for each customer**.  
**20.** Show the **total sales by product category**.

---

## **Products & Inventory**

```sql
-- Products table
CREATE TABLE Products (
    product_id   INT PRIMARY KEY,
    product_name NVARCHAR(100) NOT NULL,
    category     NVARCHAR(100) NOT NULL,
    unit_price   DECIMAL(12,2) NOT NULL,
    stock_qty    INT NOT NULL
);
```

---

**21.** Retrieve the **products that were never ordered**.  
**22.** Show the **top 3 best-selling products** by order quantity.  
**23.** List the **products whose price is above the average price** of all products.  
**24.** Find the **products that are out of stock** (quantity = 0).  
**25.** Show the **total revenue generated by each product**.  
**26.** Retrieve the **products that have been ordered by more than 10 different customers**.  
**27.** List products that were **ordered in the last 30 days but not in the previous 60 days**.  
**28.** Find the **most expensive product in each category**.  
**29.** Display the **products where stock quantity is less than 10**.  
**30.** Show the **total number of unique products ordered by each customer**.
