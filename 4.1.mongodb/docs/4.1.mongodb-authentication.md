# **ğŸ”’ MongoDB Security â€“ Authentication, Encryption & Best Practices ğŸš€**

MongoDB security is **crucial** to prevent **unauthorized access, data breaches, and attacks** like **NoSQL Injection, Privilege Escalation, and Data Exfiltration**.

---

## **ğŸ”‘ 1ï¸âƒ£ Authentication â€“ How MongoDB Verifies Users**

ğŸ’¡ **Authentication ensures that only authorized users can connect to MongoDB.**

### **ğŸ“Œ Supported Authentication Methods**

âœ”ï¸ **SCRAM (Salted Challenge Response Authentication Mechanism) â€“ Default method in MongoDB.**  
âœ”ï¸ **X.509 Certificates â€“ Used for client-server authentication in secure environments.**  
âœ”ï¸ **LDAP (Lightweight Directory Access Protocol) â€“ Integrates with enterprise authentication.**  
âœ”ï¸ **Kerberos â€“ Secure authentication in corporate networks.**

---

### **ğŸ” How to Enable Authentication in MongoDB**

By default, **MongoDB does NOT require authentication**, which is a security risk.

#### **ğŸ’¡ Steps to Enable Authentication**

1ï¸âƒ£ **Create an admin user in the `admin` database.**

```json
use admin
db.createUser({
  user: "admin",
  pwd: "StrongPassword123!",
  roles: [ { role: "userAdminAnyDatabase", db: "admin" } ]
})
```

2ï¸âƒ£ **Enable authentication in `mongod.conf`.**

```yaml
security:
  authorization: enabled
```

3ï¸âƒ£ **Restart MongoDB with authentication.**

```bash
sudo systemctl restart mongod
```

4ï¸âƒ£ **Login as an authenticated user.**

```bash
mongo -u admin -p --authenticationDatabase admin
```

âœ”ï¸ **Now, only authenticated users can access MongoDB.**

---

## **ğŸ·ï¸ 2ï¸âƒ£ Authorization & Role-Based Access Control (RBAC)**

ğŸ’¡ **Authorization determines what users can do once they authenticate.**

MongoDB uses **Role-Based Access Control (RBAC)** to manage **permissions**.

### **ğŸ“Œ Built-in Roles**

| **Role**         | **Permissions**                                       |
| ---------------- | ----------------------------------------------------- |
| **read**         | Can read data but not modify it.                      |
| **readWrite**    | Can read & write data but cannot modify settings.     |
| **dbAdmin**      | Can modify database structure (indexes, collections). |
| **userAdmin**    | Can create and manage users & roles.                  |
| **clusterAdmin** | Full control over replication & sharding.             |

âœ”ï¸ **Best Practice:** **Grant the **least privileges** necessary for each user.**

#### **ğŸ’¡ Example: Create a Read-Only User for `customers` Database**

```json
use customers
db.createUser({
  user: "readonly",
  pwd: "SecurePass123!",
  roles: [ { role: "read", db: "customers" } ]
})
```

âœ”ï¸ **Now, the `readonly` user can only view data but cannot modify it.**

---

## **ğŸŒ 3ï¸âƒ£ Network Security â€“ Preventing Unauthorized Access**

MongoDB should **never be exposed to the public internet** without security measures.

### **ğŸ’¡ How to Secure MongoDB Network Access**

âœ”ï¸ **Bind MongoDB to localhost or a private IP.**

```yaml
net:
  bindIp: 127.0.0.1
```

âœ”ï¸ **Use a Firewall (`iptables` or `ufw`) to restrict external access.**

```bash
sudo ufw allow from 192.168.1.100 to any port 27017
```

âœ”ï¸ **Enable TLS/SSL encryption for secure connections.**  
âœ”ï¸ **Disable HTTP Status Interface (`httpInterfaceEnabled: false`).**  
âœ”ï¸ **Use a VPN or SSH Tunnel to access MongoDB remotely.**

---

## **ğŸ” 4ï¸âƒ£ Encryption â€“ Securing Data at Rest & in Transit**

ğŸ’¡ **MongoDB provides encryption to protect sensitive data.**

### **ğŸ“Œ Encryption at Rest (Data Stored on Disk)**

âœ”ï¸ **MongoDB Enterprise Edition supports WiredTiger Encryption.**  
âœ”ï¸ **Encryption uses AES-256 with local or cloud-managed keys.**  
âœ”ï¸ **Enable encryption in `mongod.conf`:**

```yaml
security:
  enableEncryption: true
  encryptionKeyFile: /etc/mongodb-encryption-key
```

### **ğŸ“Œ Encryption in Transit (Data in Network)**

âœ”ï¸ **Use TLS/SSL to encrypt connections between clients & servers.**  
âœ”ï¸ **Enable TLS/SSL in `mongod.conf`:**

```yaml
net:
  ssl:
    mode: requireSSL
    PEMKeyFile: /etc/ssl/mongodb.pem
```

âœ”ï¸ **Force clients to connect securely:**

```bash
mongo --ssl --sslPEMKeyFile /etc/ssl/mongodb.pem
```

âœ”ï¸ **Now, all data is encrypted in transit, preventing man-in-the-middle attacks.**

---

## **ğŸ“œ 5ï¸âƒ£ MongoDB Security Best Practices**

âœ”ï¸ **Enable authentication & use strong passwords.**  
âœ”ï¸ **Restrict network access & never expose MongoDB to the public.**  
âœ”ï¸ **Use Role-Based Access Control (RBAC) to grant minimal permissions.**  
âœ”ï¸ **Enable TLS/SSL encryption for secure communication.**  
âœ”ï¸ **Use MongoDB Enterprise for built-in data encryption.**  
âœ”ï¸ **Regularly back up data & test disaster recovery plans.**  
âœ”ï¸ **Monitor logs (`mongod.log`) for suspicious activity.**

---
